a09c329883733d76e1f39675dacb297b
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const user_entity_1 = require("./user.entity");
const bcrypt = require("bcryptjs");
describe('User entity', () => {
    let user;
    beforeEach(() => {
        user = new user_entity_1.User();
        user.password = 'testPassword';
        user.salt = 'testSalt';
        bcrypt.hash = jest.fn();
    });
    describe('validatePassword', () => {
        it('returns true as password is valid', async () => {
            bcrypt.hash.mockReturnValue('testPassword');
            expect(bcrypt.hash).not.toHaveBeenCalled();
            const result = user.validatePassword('123456');
            expect(bcrypt.hash).toHaveBeenCalledWith('123456', 'testSalt');
            expect(result).toEqual(true);
        });
        it('returns false as password is invalid', async () => {
            bcrypt.hash.mockReturnValue('wrongPassword');
            expect(bcrypt.hash).not.toHaveBeenCalled();
            const result = user.validatePassword('wrondPassword');
            expect(bcrypt.hash).toHaveBeenCalledWith('123456', 'testSalt');
            expect(result).toEqual(false);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvaGVyb2t1L1Byb2plY3RzL1N0dWR5aW5nL05lc3RKUy9uZXN0anMtdGFzay1tYW5hZ2VtZW5ldC9iYWNrZW5kL3NyYy9hdXRoL3VzZXIuZW50aXR5LnNwZWMudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSwrQ0FBb0M7QUFDcEMsbUNBQWtDO0FBRWxDLFFBQVEsQ0FBQyxhQUFhLEVBQUUsR0FBRyxFQUFFO0lBQzVCLElBQUksSUFBVSxDQUFBO0lBRWQsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNmLElBQUksR0FBRyxJQUFJLGtCQUFJLEVBQUUsQ0FBQTtRQUNqQixJQUFJLENBQUMsUUFBUSxHQUFHLGNBQWMsQ0FBQTtRQUM5QixJQUFJLENBQUMsSUFBSSxHQUFHLFVBQVUsQ0FBQTtRQUN0QixNQUFNLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQTtJQUN4QixDQUFDLENBQUMsQ0FBQTtJQUNGLFFBQVEsQ0FBQyxrQkFBa0IsRUFBRSxHQUFHLEVBQUU7UUFDakMsRUFBRSxDQUFDLG1DQUFtQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2xELE1BQU0sQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLGNBQWMsQ0FBQyxDQUFBO1lBQzNDLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLGdCQUFnQixFQUFFLENBQUE7WUFDMUMsTUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLFFBQVEsQ0FBQyxDQUFBO1lBQzlDLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsb0JBQW9CLENBQUMsUUFBUSxFQUFFLFVBQVUsQ0FBQyxDQUFBO1lBQzlELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUE7UUFDN0IsQ0FBQyxDQUFDLENBQUE7UUFFRixFQUFFLENBQUMsc0NBQXNDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDckQsTUFBTSxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsZUFBZSxDQUFDLENBQUE7WUFDNUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQTtZQUMxQyxNQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsZUFBZSxDQUFDLENBQUE7WUFDckQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxRQUFRLEVBQUUsVUFBVSxDQUFDLENBQUE7WUFDOUQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQTtRQUM5QixDQUFDLENBQUMsQ0FBQTtJQUNILENBQUMsQ0FBQyxDQUFBO0FBQ0gsQ0FBQyxDQUFDLENBQUEiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL2hvbWUvaGVyb2t1L1Byb2plY3RzL1N0dWR5aW5nL05lc3RKUy9uZXN0anMtdGFzay1tYW5hZ2VtZW5ldC9iYWNrZW5kL3NyYy9hdXRoL3VzZXIuZW50aXR5LnNwZWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVXNlciB9IGZyb20gJy4vdXNlci5lbnRpdHknXG5pbXBvcnQgKiBhcyBiY3J5cHQgZnJvbSAnYmNyeXB0anMnXG5cbmRlc2NyaWJlKCdVc2VyIGVudGl0eScsICgpID0+IHtcblx0bGV0IHVzZXI6IFVzZXJcblxuXHRiZWZvcmVFYWNoKCgpID0+IHtcblx0XHR1c2VyID0gbmV3IFVzZXIoKVxuXHRcdHVzZXIucGFzc3dvcmQgPSAndGVzdFBhc3N3b3JkJ1xuXHRcdHVzZXIuc2FsdCA9ICd0ZXN0U2FsdCdcblx0XHRiY3J5cHQuaGFzaCA9IGplc3QuZm4oKVxuXHR9KVxuXHRkZXNjcmliZSgndmFsaWRhdGVQYXNzd29yZCcsICgpID0+IHtcblx0XHRpdCgncmV0dXJucyB0cnVlIGFzIHBhc3N3b3JkIGlzIHZhbGlkJywgYXN5bmMgKCkgPT4ge1xuXHRcdFx0YmNyeXB0Lmhhc2gubW9ja1JldHVyblZhbHVlKCd0ZXN0UGFzc3dvcmQnKVxuXHRcdFx0ZXhwZWN0KGJjcnlwdC5oYXNoKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpXG5cdFx0XHRjb25zdCByZXN1bHQgPSB1c2VyLnZhbGlkYXRlUGFzc3dvcmQoJzEyMzQ1NicpXG5cdFx0XHRleHBlY3QoYmNyeXB0Lmhhc2gpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcxMjM0NTYnLCAndGVzdFNhbHQnKVxuXHRcdFx0ZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh0cnVlKVxuXHRcdH0pXG5cblx0XHRpdCgncmV0dXJucyBmYWxzZSBhcyBwYXNzd29yZCBpcyBpbnZhbGlkJywgYXN5bmMgKCkgPT4ge1xuXHRcdFx0YmNyeXB0Lmhhc2gubW9ja1JldHVyblZhbHVlKCd3cm9uZ1Bhc3N3b3JkJylcblx0XHRcdGV4cGVjdChiY3J5cHQuaGFzaCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKVxuXHRcdFx0Y29uc3QgcmVzdWx0ID0gdXNlci52YWxpZGF0ZVBhc3N3b3JkKCd3cm9uZFBhc3N3b3JkJylcblx0XHRcdGV4cGVjdChiY3J5cHQuaGFzaCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJzEyMzQ1NicsICd0ZXN0U2FsdCcpXG5cdFx0XHRleHBlY3QocmVzdWx0KS50b0VxdWFsKGZhbHNlKVxuXHRcdH0pXG5cdH0pXG59KSJdLCJ2ZXJzaW9uIjozfQ==